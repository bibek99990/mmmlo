<!DOCTYPE html>
<html>
<body>
<h2>Register</h2>

<input id="username" placeholder="Username"><br>
<input id="password" type="password" placeholder="Password"><br>
<button onclick="register()">Register</button>

<script>
async function generateKeys(){
const keyPair = await crypto.subtle.generateKey({
name:"RSA-OAEP",
modulusLength:2048,
publicExponent:new Uint8Array([1,0,1]),
hash:"SHA-256"
},true,["encrypt","decrypt"]);

const publicKey = await crypto.subtle.exportKey("spki",keyPair.publicKey);
const privateKey = await crypto.subtle.exportKey("pkcs8",keyPair.privateKey);

localStorage.setItem("privateKey",btoa(String.fromCharCode(...new Uint8Array(privateKey))));
return btoa(String.fromCharCode(...new Uint8Array(publicKey)));
}

async function register(){
const publicKey = await generateKeys();

await fetch("/register",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
username:username.value,
password:password.value,
publicKey
})
});
alert("Registered");
}
</script>
</body>
</html>
